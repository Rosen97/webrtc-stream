(function(e){function t(t){for(var o,a,c=t[0],u=t[1],s=t[2],p=0,f=[];p<c.length;p++)a=c[p],r[a]&&f.push(r[a][0]),r[a]=0;for(o in u)Object.prototype.hasOwnProperty.call(u,o)&&(e[o]=u[o]);d&&d(t);while(f.length)f.shift()();return i.push.apply(i,s||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],o=!0,c=1;c<n.length;c++){var u=n[c];0!==r[u]&&(o=!1)}o&&(i.splice(t--,1),e=a(a.s=n[0]))}return e}var o={},r={app:0},i=[];function a(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=o,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)a.d(n,o,function(t){return e[t]}.bind(null,o));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],u=c.push.bind(c);c.push=t,c=c.slice();for(var s=0;s<c.length;s++)t(c[s]);var d=u;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},1:function(e,t){},"21bb":function(e,t,n){"use strict";var o=n("4c07"),r=n.n(o);r.a},"4a19":function(e,t,n){},"4c07":function(e,t,n){},5606:function(e,t,n){"use strict";var o=n("6237"),r=n.n(o);r.a},"56d7":function(e,t,n){"use strict";n.r(t);n("3a0f"),n("a3a3"),n("4d0b");var o=n("329b"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},i=[],a=(n("5c0b"),n("048f")),c={},u=Object(a["a"])(c,r,i,!1,null,null,null);u.options.__file="App.vue";var s=u.exports,d=n("b8e5"),p=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home"},[n("div",{staticClass:"center"},[e._v("\n        登录名："),n("input",{directives:[{name:"model",rawName:"v-model",value:e.account,expression:"account"}],attrs:{type:"text"},domProps:{value:e.account},on:{input:function(t){t.target.composing||(e.account=t.target.value)}}}),n("br"),e._v("\n        房间号："),n("input",{directives:[{name:"model",rawName:"v-model",value:e.roomid,expression:"roomid"}],attrs:{type:"text"},domProps:{value:e.roomid},on:{input:function(t){t.target.composing||(e.roomid=t.target.value)}}}),n("br"),n("button",{on:{click:e.join}},[e._v("加入房间")])])])},f=[],l={name:"home",data:function(){return{roomid:"",account:""}},methods:{join:function(){this.account&&this.roomid&&this.$router.push({name:"room",params:{roomid:this.roomid,account:this.account}})}}},m=l,v=(n("21bb"),Object(a["a"])(m,p,f,!1,null,null,null));v.options.__file="Home.vue";var h=v.exports,b=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"room"},[n("div",{staticClass:"video-box"},[n("video",{ref:"video-mine",staticClass:"video-mine",attrs:{autoplay:"",controls:""}}),n("video",{ref:"video-other",staticClass:"video-other",attrs:{autoplay:"",controls:""}})])])},w=[],_=n("497e"),g=n.n(_),y=g.a.connect("http://192.168.13.28:3001"),j=y,O={name:"home",data:function(){return{roomid:"",pper:null,peer1:null,candidate:null}},methods:{init:function(){var e=this,t=this.$refs["video-mine"],n=this.$refs["video-other"],o={iceServers:[{url:"stun:stun.l.google.com:19302"}]},r=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,i=window.PeerConnection||window.webkitPeerConnection00||window.webkitRTCPeerConnection||window.mozRTCPeerConnection;return this.pper=new i(o),this.pper.onaddstream=function(e){n&&(n.srcObject=e.stream)},this.pper.onicecandidate=function(t){t.candidate&&(e.candidate=t.candidate)},new Promise(function(n,o){r.call(navigator,{audio:!0,video:!0},function(o){t.srcObject=o,e.pper.addStream(o),n()},function(e){o(e)})})},sendOfferFn:function(e){var t=this;this.pper.setLocalDescription(e,function(){j.emit("offer",{sdp:t.pper.localDescription,roomid:t.$route.params.roomid})})},sendAnswerFn:function(e){var t=this;this.pper.setLocalDescription(e,function(){j.emit("answer",{sdp:t.pper.localDescription,roomid:t.$route.params.roomid})})},socketInit:function(){this.pper.createOffer({offerToReceiveAudio:1,offerToReceiveVideo:1}).then(this.sendOfferFn)}},mounted:function(){var e=this;this.$nextTick(function(){j.emit("join",{roomid:e.$route.params.roomid,account:e.$route.params.account}),j.on("offer",function(t){e.pper.setRemoteDescription(t,function(){e.pper.createAnswer().then(e.sendAnswerFn)},function(){})}),j.on("answer",function(t){e.pper.setRemoteDescription(t,function(){},function(){})}),j.on("__ice_candidate",function(t){t&&e.pper.addIceCandidate(t).catch(function(){})}),j.on("__ice_candidatepeer",function(t){t&&e.peer1.addIceCandidate(t).catch(function(){})}),j.on("joined",function(t){e.init().then(function(){j.emit("__ice_candidate",{candidate:e.candidate,roomid:e.$route.params.roomid}),2===t.length&&e.socketInit()})})})}},x=O,C=(n("5606"),Object(a["a"])(x,b,w,!1,null,null,null));C.options.__file="room.vue";var P=C.exports;o["a"].use(d["a"]);var $=new d["a"]({routes:[{path:"/",name:"home",component:h},{path:"/room/:roomid/:account",name:"room",component:P}]}),k=n("f2de");o["a"].use(k["a"]);var M=new k["a"].Store({state:{},mutations:{},actions:{}});j.on("connect",function(){console.log("连接成功")}),j.on("disconnect",function(){console.log("连接断开了")}),o["a"].config.productionTip=!1,new o["a"]({router:$,store:M,render:function(e){return e(s)}}).$mount("#app")},"5c0b":function(e,t,n){"use strict";var o=n("4a19"),r=n.n(o);r.a},6237:function(e,t,n){}});